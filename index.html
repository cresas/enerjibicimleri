<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Enerji BiÃ§imleri â†” GÃ¼nlÃ¼k Hayat Ã–rnekleri</title>
  <style>
    :root{
      --bg-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
      --bg: #0f172a;
      --text: #f1f5f9;
      --text-muted: #94a3b8;
      --border: #334155;
      --border-strong: #475569;
      --panel: #1e293b;
      --panel-hover: #334155;
      --card-bg: #f8fafc;
      --card-text: #1e293b;
      --green: #10b981;
      --green-glow: #34d399;
      --rose: #f43f5e;
      --rose-glow: #fb7185;
      --accent: #06b6d4;
      --accent-glow: #22d3ee;
    }
    
    *{box-sizing:border-box;margin:0;padding:0}
    
    html{
      height: 100%;
      /* Mobil kaydÄ±rmayÄ± etkin tutar */
      overflow-x: hidden;
    }
    
    body{
      /* MOBÄ°LDE ORÄ°JÄ°NAL HÄ°ZALAMA */
      display: block;
      min-height: 100vh; 
      margin: 0; 
      
      /* Ã–LÃ‡EKLENDÄ°RME KALDIRILDI */
      transform: none; 
      transform-origin: top center; 
      
      /* Geri kalan stiller */
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
      background:var(--bg);
      background-image:var(--bg-gradient);
      background-attachment:fixed;
      color:var(--text);
      line-height:1.6;
    }

    /* YALNIZCA MASAÃœSTÃœ Ä°Ã‡Ä°N Ã–LÃ‡EKLENDÄ°RME VE HÄ°ZALAMA */
    @media (min-width: 768px) {
        html {
            overflow: hidden; /* MasaÃ¼stÃ¼nde kaydÄ±rma Ã§ubuÄŸunu kaldÄ±rÄ±r */
        }
        body {
            display: flex;
            justify-content: center; /* Yatayda ortala */
            align-items: flex-start; /* Ä°Ã§eriÄŸi yukarÄ± hizala */
            
            /* Ã–LÃ‡EK: %75 */
            transform: scale(0.8);
            transform-origin: top center;
        }
    }
    
    .container{
      max-width:1200px;
      margin:0 auto;
      padding:16px 20px 120px;
      width: 100%;
    }
    
    header.appbar{
      position:relative;
      top:0;
      z-index:10;
      background:rgba(15,23,42,.85);
      backdrop-filter:saturate(1.3) blur(12px);
      border-bottom:1px solid var(--border);
      border-radius:0 0 16px 16px;
      padding:16px 20px;
      margin-bottom:24px;
      box-shadow:0 4px 20px rgba(0,0,0,.3);
      transform:translateY(0);
      transition:transform 0.3s ease;
    }
    
    header.appbar.hidden{
      transform:translateY(-100%);
    }
    
    @media (min-width:768px){
      header.appbar.hidden{
        transform:translateY(0);
      }
    }
    
    /* BaÅŸlÄ±k daha bÃ¼yÃ¼k ve Ã§arpÄ±cÄ± */
    h1{
      font-size:clamp(28px,4.5vw,40px); 
      margin:0 0 10px; 
      font-weight:800;
      background:linear-gradient(120deg, var(--accent-glow), var(--green-glow));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
    }
    
    /* AÃ§Ä±klama paragrafÄ± 18px ve daha belirgin */
    p.lead{
      margin:0;
      color:var(--text); 
      font-size:clamp(15px,2.5vw,18px); 
      line-height:1.6;
      font-weight: 500; 
    }
    
    .btn{
      appearance:none;
      border:2px solid var(--accent);
      background:linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
      color:#fff;
      border-radius:12px;
      padding:12px 24px;
      cursor:pointer;
      box-shadow:0 4px 12px rgba(6,182,212,.3);
      font-weight:600;
      font-size:15px;
      transition:all .2s ease;
      position:relative;
      overflow:hidden;
      flex-grow: 1; /* Mobil butonlarÄ±n eÅŸit bÃ¼yÃ¼mesi iÃ§in */
      white-space: nowrap;
    }
    
    .btn::before{
      content:'';
      position:absolute;
      top:0;
      left:-100%;
      width:100%;
      height:100%;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,.2), transparent);
      transition:left .5s;
    }
    
    .btn:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(6,182,212,.4);
      border-color:var(--accent-glow);
    }
    
    .btn:hover::before{
      left:100%;
    }
    
    .btn:active{
      transform:translateY(0);
    }
    
    @media (min-width:768px){
      .btn{
        padding:16px 32px;
        font-size:16px;
      }
    }
    
    .score{
      font-size:16px;
      color:var(--text);
      margin:8px 0 24px;
      padding:12px 20px;
      background:rgba(6,182,212,.1);
      border:1px solid var(--accent);
      border-radius:12px;
      display:inline-block;
    }

    /* MOBÄ°L KONTROL ALANI: GÄ°ZLENDÄ° */
    .mobile-controls {
        display: none;
    }
    
    /* SADECE SÄ°MGE Ä°Ã‡EREN BUTONLAR Ä°Ã‡Ä°N STÄ°L */
    .mobile-controls .btn-icon-only {
        flex-grow: 0; 
        width: 44px; /* Sabit kare geniÅŸlik */
        padding: 12px; 
        font-size: 18px;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-left: 0; /* SÄ±fÄ±rlama */
    }
    
    /* MASAÃœSTÃœ KONTROLLERÄ° */
    .desktop-controls {
        display: none;
        justify-content: center;
        gap: 16px;
        margin-top: 32px;
        flex-wrap: wrap;
    }

    /* MASAÃœSTÃœ KONTROLLERÄ° GÃ–STER */
    @media (min-width: 768px) {
        .desktop-controls {
            display: flex;
        }
    }
    
    .score b{
      color:var(--accent-glow);
      font-size:20px;
    }

    .zone{
      border:2px solid var(--border-strong);
      border-radius:16px;
      background:var(--panel);
      padding:16px;
      min-height:8rem;
      transition:all .2s ease;
      box-shadow:0 2px 8px rgba(0,0,0,.2);
    }
    
    .zone.pool{
      border-style:dashed;
      border-color:var(--accent);
      background:rgba(6,182,212,.05);
    }
    
    .zone:hover{
      background:var(--panel-hover);
      border-color:var(--accent);
      transform:translateY(-2px);
      box-shadow:0 4px 16px rgba(0,0,0,.3);
    }
    
    .zone-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
      padding-bottom:8px;
      border-bottom:1px solid var(--border);
    }
    
    .zone-title{
      font-weight:700;
      font-size:15px;
      color:var(--accent-glow);
    }
    
    .zone-count{
      font-size:13px;
      color:var(--text-muted);
      background:rgba(148,163,184,.1);
      padding:2px 8px;
      border-radius:8px;
    }
    
    .cards{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }

    .card{
      user-select:none;
      cursor:move;
      border:2px solid #cbd5e1;
      background:var(--card-bg);
      color:var(--card-text);
      border-radius:10px;
      padding:10px 16px;
      box-shadow:0 2px 6px rgba(0,0,0,.15);
      font-size:14px;
      font-weight:500;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition:all .15s ease;
    }
    
    .card:hover{
      box-shadow:0 4px 12px rgba(0,0,0,.25);
      transform:translateY(-2px);
      border-color:#94a3b8;
    }
    
    .card.correct{
      border-color:var(--green);
      background:linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
      box-shadow:0 4px 12px rgba(16,185,129,.3);
    }
    
    .card.wrong{
      border-color:var(--rose);
      background:linear-gradient(135deg, #ffe4e6 0%, #fecdd3 100%);
      box-shadow:0 4px 12px rgba(244,63,94,.3);
    }
    
    .card.selected{
      outline:3px solid var(--accent);
      outline-offset:2px;
      transform:scale(1.05);
      box-shadow:0 0 20px rgba(6,182,212,.5);
    }
    
    .tick{
      font-size:14px;
      font-weight:bold;
    }

    .grid{
      display:grid;
      gap:16px;
      margin-bottom:32px;
    }
    
    @media (min-width:640px){
      .grid{
        grid-template-columns:repeat(2,minmax(0,1fr));
      }
    }
    
    @media (min-width:1024px){
      .grid{
        grid-template-columns:repeat(3,minmax(0,1fr));
      }
    }

    /* FAB alanÄ± tamamen gizlendi */
    .fab{
        display: none;
    }

    .muted{
      color:var(--text-muted);
      font-size:18px; 
      margin-top:32px; /* Mobil kontrolden sonra bu marjini geri getirdik */
      padding:16px;
      background:rgba(148,163,184,.05);
      border-radius:12px;
      border-left:3px solid var(--accent);
    }
    
    .section-title{
      font-size:18px;
      margin:0 0 12px;
      font-weight:700;
      color:var(--accent-glow);
    }
    
    .modal-overlay{
      position:fixed;
      top:0;
      left:0;
      right:0;
      bottom:0;
      background:rgba(0,0,0,0.8);
      backdrop-filter:blur(8px);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:9999;
      animation:fadeIn 0.3s ease;
    }
    
    .modal-overlay.show{
      display:flex;
    }
    
    @keyframes fadeIn{
      from{opacity:0;}
      to{opacity:1;}
    }
    
    @keyframes scaleIn{
      from{transform:scale(0.8); opacity:0;}
      to{transform:scale(1); opacity:1;}
    }
    
    .modal-card{
      background:linear-gradient(135deg, var(--panel) 0%, #334155 100%);
      border:3px solid var(--green-glow);
      border-radius:24px;
      padding:48px 32px;
      max-width:500px;
      width:90%;
      text-align:center;
      box-shadow:0 20px 60px rgba(0,0,0,0.5), 0 0 0 1px rgba(52,211,153,0.2);
      animation:scaleIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    
    .modal-icon{
      font-size:80px;
      margin-bottom:24px;
      animation:bounce 0.6s ease;
    }
    
    @keyframes bounce{
      0%, 100%{transform:translateY(0);}
      50%{transform:translateY(-20px);}
    }
    
    .modal-title{
      font-size:32px;
      font-weight:800;
      background:linear-gradient(120deg, var(--green-glow), var(--accent-glow));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
      margin:0 0 16px;
    }
    
    .modal-text{
      font-size:18px;
      color:var(--text);
      margin:0 0 32px;
      line-height:1.6;
    }
    
    .modal-btn{
      appearance:none;
      border:2px solid var(--green);
      background:linear-gradient(135deg, var(--green) 0%, #059669 100%);
      color:#fff;
      border-radius:12px;
      padding:16px 48px;
      cursor:pointer;
      box-shadow:0 4px 12px rgba(16,185,129,.4);
      font-weight:700;
      font-size:16px;
      transition:all .2s ease;
    }
    
    .modal-btn:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(16,185,129,.6);
      border-color:var(--green-glow);
    }
    
    .modal-btn:active{
      transform:translateY(0);
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="appbar">
      <div>
        <h1>âš¡ Enerji BiÃ§imleri â†” GÃ¼nlÃ¼k Hayat Ã–rnekleri</h1>
        <p class="lead">KartlarÄ± uygun enerji kategorisine sÃ¼rÃ¼kleyip bÄ±rakÄ±n. Ä°sterseniz bir karta tÄ±klayÄ±p ardÄ±ndan bir kategoriye tÄ±klayarak da yerleÅŸtirebilirsiniz. BazÄ± olaylar birden fazla enerji dÃ¶nÃ¼ÅŸÃ¼mÃ¼ iÃ§erebilir; en baskÄ±n olanÄ± dÃ¼ÅŸÃ¼nÃ¼n.</p>
      </div>
    </header>

    <section class="score" id="scoreArea">Skor: <b>0</b> / 0</section>

    <section style="margin-bottom:24px">
      <h2 class="section-title">ğŸ´ Kart Havuzu</h2>
      <div class="zone pool" id="zone-pool" data-zone="pool" role="region" aria-label="BoÅŸ Kart AlanÄ±">
        <div class="zone-header"><span class="zone-title">BoÅŸ Kart AlanÄ±</span><span class="zone-count" id="count-pool">0 kart</span></div>
        <div class="cards" id="cards-pool"></div>
      </div>
    </section>

    <section>
      <h2 class="section-title">ğŸ“š Enerji Kategorileri</h2>
      <div class="grid" id="grid-categories"></div>
    </section>
    
    <div class="mobile-controls">
        <button class="btn" id="btnCheckMobile" title="Kontrol Et">âœ“ Kontrol Et</button>
        <button class="btn btn-icon-only" id="btnResetMobile" title="SÄ±fÄ±rla">â†»</button>
        <button class="btn btn-icon-only" id="btnRevealMobile" title="CevaplarÄ± GÃ¶ster">ğŸ‘</button>
    </div>

    <div class="desktop-controls">
      <button class="btn" id="btnCheckDesktop">âœ“ Kontrol Et</button>
      <button class="btn" id="btnResetDesktop">â†» SÄ±fÄ±rla</button>
      <button class="btn" id="btnRevealDesktop">ğŸ‘ CevaplarÄ± GÃ¶ster</button>
    </div>

    <div class="fab"></div>

    <footer class="muted">
      <strong>ğŸ’¡ Not:</strong> Ã–rneÄŸin "mum alevi" kimyasal enerjinin Ä±ÅŸÄ±k ve Ä±sÄ±ya dÃ¶nÃ¼ÅŸmesine Ã¶rnektir. Bu etkinlikte kartlar baskÄ±n gÃ¶rÃ¼len enerji biÃ§imine gÃ¶re eÅŸleÅŸtirilecek ÅŸekilde hazÄ±rlanmÄ±ÅŸtÄ±r. Ancak "Mum alevi" kartlarÄ± Ã¶zel olarak hem IsÄ± hem de IÅŸÄ±k Enerjisi kutularÄ±na yerleÅŸtirilebilir.
    </footer>
  </div>

  <div class="modal-overlay" id="congratsModal">
    <div class="modal-card">
      <div class="modal-icon">ğŸ‰</div>
      <h2 class="modal-title">Tebrikler!</h2>
      <p class="modal-text">TÃ¼m eÅŸleÅŸmeleri doÄŸru yaptÄ±nÄ±z! ğŸŒŸ</p>
      <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap;">
        <button class="modal-btn" onclick="document.getElementById('congratsModal').classList.remove('show')">Kapat</button>
        <button class="modal-btn" onclick="document.getElementById('congratsModal').classList.remove('show');resetAll();">ğŸ”„ Yeniden BaÅŸlat</button>
      </div>
    </div>
  </div>

  <script>
  // --- Veri ---
  const CATEGORIES = [
    { id: "mekanik", title: "âš™ï¸ Mekanik Enerji" },
    { id: "isi", title: "ğŸ”¥ IsÄ± (Termal) Enerji" },
    { id: "elektrik", title: "âš¡ Elektrik Enerjisi" },
    { id: "ses", title: "ğŸ”Š Ses Enerjisi" },
    { id: "isik", title: "ğŸ’¡ IÅŸÄ±k Enerjisi" },
    { id: "kimyasal", title: "ğŸ§ª Kimyasal Enerji" },
    { id: "nukleer", title: "â˜¢ï¸ NÃ¼kleer Enerji" },
  ];

  const EXAMPLES = [
    { id: "ex1", text: "ZÄ±playan top", category: "mekanik", hint: "Potansiyel â†” kinetik enerji dÃ¶nÃ¼ÅŸÃ¼mÃ¼" },
    { id: "ex2", text: "Bisiklet pedalÄ±yla hÄ±zlanma", category: "mekanik", hint: "Kas gÃ¼cÃ¼ hareket enerjisine dÃ¶nÃ¼ÅŸÃ¼r" },
    { id: "ex3", text: "RÃ¼zgÃ¢r tÃ¼rbini kanadÄ±nÄ±n dÃ¶nmesi", category: "mekanik", hint: "HavanÄ±n hareketi kanatlarÄ± Ã§evirir" },
    { id: "ex4", text: "Kaynayan Ã§aydanlÄ±k", category: "isi", hint: "IsÄ±, suyun sÄ±caklÄ±ÄŸÄ±nÄ± artÄ±rÄ±r" },
    { id: "ex5", text: "SÃ¼rtÃ¼nerek Ä±sÄ±nan eller", category: "isi", hint: "SÃ¼rtÃ¼nme Ä±sÄ± Ã¼retir" },
    { id: "ex7", text: "Telefonu ÅŸarj etmek", category: "elektrik", hint: "Elektrik, bataryada depolanÄ±r" },
    { id: "ex8", text: "Prizden Ã§alÄ±ÅŸan bilgisayar", category: "elektrik", hint: "CihazÄ±n Ã§alÄ±ÅŸmasÄ± iÃ§in elektrik" },
    { id: "ex9", text: "Elektrikli sÃ¼pÃ¼rge", category: "elektrik", hint: "Elektrik motoru Ã§alÄ±ÅŸtÄ±rÄ±r" },
    { id: "ex10", text: "Zil Ã§almasÄ±", category: "ses", hint: "TitreÅŸimler havada yayÄ±lan ses dalgalarÄ±dÄ±r" },
    { id: "ex11", text: "HoparlÃ¶rden mÃ¼zik", category: "ses", hint: "TitreÅŸimden ses oluÅŸur" },
    { id: "ex12", text: "Ambulans sireni", category: "ses", hint: "YÃ¼ksek frekanslÄ± ses dalgalarÄ±" },
    { id: "ex13", text: "El feneri Ä±ÅŸÄ±ÄŸÄ±", category: "isik", hint: "Elektrik â†’ Ä±ÅŸÄ±k" },
    
    // 1. Mum Alevi KartÄ± (Hem IsÄ± hem IÅŸÄ±k kabul eder)
    { id: "ex14", text: "Mum alevi", category: "isik", hint: "Kimyasal enerji â†’ Ä±ÅŸÄ±k ve Ä±sÄ±" }, 
    
    // 2. Mum Alevi KartÄ± (Hem IsÄ± hem IÅŸÄ±k kabul eder)
    { id: "ex22", text: "Mum alevi", category: "isi", hint: "Kimyasal enerji â†’ Ä±ÅŸÄ±k ve Ä±sÄ±" }, 
    
    { id: "ex15", text: "GÃ¼neÅŸ panellerine gelen gÃ¼neÅŸ Ä±ÅŸÄ±ÄŸÄ±", category: "isik", hint: "IÅŸÄ±ÄŸÄ±n enerjisi elektrik Ã¼retir" },
    { id: "ex16", text: "Pillerin enerji depolamasÄ±", category: "kimyasal", hint: "Kimyasal baÄŸlarda enerji" },
    { id: "ex17", text: "Benzinle Ã§alÄ±ÅŸan araba", category: "kimyasal", hint: "YakÄ±t yanÄ±nca enerji aÃ§Ä±ÄŸa Ã§Ä±kar" },
    { id: "ex19", text: "NÃ¼kleer santralde enerji Ã¼retimi", category: "nukleer", hint: "Ã‡ekirdek tepkimeleri Ä±sÄ± ve elektrik Ã¼retir" },
    { id: "ex20", text: "GÃ¼neÅŸteki reaksiyonlar", category: "nukleer", hint: "GÃ¼neÅŸ enerjisinin kaynaÄŸÄ± nÃ¼kleer tepkimelerdir" },
    { id: "ex21", text: "Radyoterapi cihazÄ±", category: "nukleer", hint: "Radyoaktif kaynaklardan enerji" },
  ];

  // --- YardÄ±mcÄ±lar ---
  function shuffle(arr){const a=[...arr];for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}

  // --- Durum ---
  let items = shuffle(EXAMPLES);
  let placement = Object.fromEntries(EXAMPLES.map(e=>[e.id,'pool'])); // exId -> zoneId
  let checked = false;
  let selected = null; // click-to-place

  // --- Ses efektleri ---
  const soundTrue = new Audio('true.mp3');
  const soundFalse = new Audio('false.mp3');
  const soundConq = new Audio('conq.mp3');

  // --- DOM referanslarÄ± ---
  const gridEl = document.getElementById('grid-categories');
  const poolCardsEl = document.getElementById('cards-pool');
  const poolZoneEl = document.getElementById('zone-pool');
  const poolCountEl = document.getElementById('count-pool');
  const scoreEl = document.getElementById('scoreArea');

  // --- Kategori alanlarÄ±nÄ± oluÅŸtur ---
  function buildCategoryGrid(){
    gridEl.innerHTML = '';
    for(const c of CATEGORIES){
      const zone = document.createElement('div');
      zone.className = 'zone';
      zone.setAttribute('data-zone', c.id);
      zone.setAttribute('role','region');
      zone.setAttribute('aria-label', c.title);
      zone.addEventListener('dragover', e=>e.preventDefault());
      zone.addEventListener('drop', e=>handleDrop(e,c.id));
      zone.addEventListener('click', ()=>handleClickZone(c.id));

      const header = document.createElement('div');
      header.className = 'zone-header';
      const title = document.createElement('span');
      title.className = 'zone-title';
      title.textContent = c.title;
      const count = document.createElement('span');
      count.className = 'zone-count';
      count.id = `count-${c.id}`;
      header.appendChild(title); header.appendChild(count);

      const cards = document.createElement('div');
      cards.className = 'cards';
      cards.id = `cards-${c.id}`;

      zone.appendChild(header); zone.appendChild(cards);
      gridEl.appendChild(zone);
    }

    // Pool olaylarÄ±
    poolZoneEl.addEventListener('dragover', e=>e.preventDefault());
    poolZoneEl.addEventListener('drop', e=>handleDrop(e,'pool'));
    poolZoneEl.addEventListener('click', ()=>handleClickZone('pool'));
  }

  // --- Touch DesteÄŸi ve Kart Åablonu ---
  let touchDraggedId = null;
  let ghostElement = null;
  let touchStartX = 0;
  let touchStartY = 0;

  function createCard(it){
    const el = document.createElement('div');
    el.className = 'card';
    el.draggable = true;
    el.title = it.hint || '';
    el.textContent = it.text;

    if(checked){
      // Kontrol kuralÄ±nÄ± burada da uygula:
      let isMultiAcceptable = (it.id === 'ex14' || it.id === 'ex22');
      let isCorrect;

      if(isMultiAcceptable){
          isCorrect = (placement[it.id] === 'isik' || placement[it.id] === 'isi');
      } else {
          isCorrect = (placement[it.id] === it.category);
      }
      
      el.classList.add(isCorrect ? 'correct':'wrong');
      const tick = document.createElement('span');
      tick.className = 'tick';
      tick.textContent = isCorrect ? 'âœ“' : 'âœ—';
      el.appendChild(tick);
    }

    if(selected === it.id){
      el.classList.add('selected');
      el.setAttribute('aria-pressed','true');
    }

    el.addEventListener('dragstart', ev=>{
      ev.dataTransfer.setData('text/plain', it.id);
      ev.dataTransfer.effectAllowed = 'move';
    });
    el.addEventListener('click', ()=>handleClickItem(it.id));

    // Touch olaylarÄ±
    el.addEventListener('touchstart', (e)=>handleTouchStart(e, it.id));
    el.addEventListener('touchmove', handleTouchMove);
    el.addEventListener('touchend', handleTouchEnd);

    return el;
  }

  function handleTouchStart(e, id){
    if(checked) return;
    touchDraggedId = id;
    const touch = e.touches[0];
    touchStartX = touch.clientX;
    touchStartY = touch.clientY;
    
    // Ghost element oluÅŸtur
    ghostElement = e.currentTarget.cloneNode(true);
    ghostElement.style.position = 'fixed';
    ghostElement.style.pointerEvents = 'none';
    ghostElement.style.zIndex = '1000';
    ghostElement.style.opacity = '0.8';
    ghostElement.style.transform = 'scale(1.1)';
    ghostElement.style.left = touch.clientX - 50 + 'px';
    ghostElement.style.top = touch.clientY - 20 + 'px';
    document.body.appendChild(ghostElement);
    
    e.preventDefault();
  }

  function handleTouchMove(e){
    if(!touchDraggedId || !ghostElement) return;
    const touch = e.touches[0];
    ghostElement.style.left = touch.clientX - 50 + 'px';
    ghostElement.style.top = touch.clientY - 20 + 'px';
    
    // Otomatik scroll
    const scrollThreshold = 100;
    const scrollSpeed = 10;
    const windowHeight = window.innerHeight;
    
    if(touch.clientY < scrollThreshold){
      // YukarÄ± scroll
      window.scrollBy(0, -scrollSpeed);
    } else if(touch.clientY > windowHeight - scrollThreshold){
      // AÅŸaÄŸÄ± scroll
      window.scrollBy(0, scrollSpeed);
    }
    
    e.preventDefault();
  }

  function handleTouchEnd(e){
    if(!touchDraggedId) return;
    
    const touch = e.changedTouches[0];
    const dropTarget = document.elementFromPoint(touch.clientX, touch.clientY);
    
    // En yakÄ±n zone'u bul
    let zone = dropTarget;
    while(zone && !zone.hasAttribute('data-zone')){
      zone = zone.parentElement;
    }
    
    if(zone){
      const zoneId = zone.getAttribute('data-zone');
      placement[touchDraggedId] = zoneId;
      selected = null;
      render();
    }
    
    // Temizle
    if(ghostElement){
      document.body.removeChild(ghostElement);
      ghostElement = null;
    }
    touchDraggedId = null;
    e.preventDefault();
  }

  // --- YerleÅŸimden gÃ¶rÃ¼nÃ¼me ---
  function render(){
    // Grupla
    const groups = { pool: [] };
    for(const c of CATEGORIES) groups[c.id] = [];
    for(const it of items){ groups[placement[it.id] || 'pool'].push(it); }

    // Havuz
    poolCardsEl.innerHTML = '';
    for(const it of groups.pool){ poolCardsEl.appendChild(createCard(it)); }
    poolCountEl.textContent = `${groups.pool.length} kart`;

    // Kategoriler
    for(const c of CATEGORIES){
      const wrap = document.getElementById(`cards-${c.id}`);
      const count = document.getElementById(`count-${c.id}`);
      wrap.innerHTML = '';
      for(const it of groups[c.id]) wrap.appendChild(createCard(it));
      count.textContent = `${groups[c.id].length} kart`;
    }

    // Skor
    const score = computeScore();
    scoreEl.innerHTML = `Skor: <b>${score.correct}</b> / ${score.total}`;
  }

  /*
  ** Ã–NEMLÄ° DEÄÄ°ÅÄ°KLÄ°K: Mum alevi (ex14 VE ex22) iÃ§in Ã¶zel kontrol eklendi.
  */
  function computeScore(){
    let correct = 0; const total = EXAMPLES.length;
    for(const it of EXAMPLES){ 
      let isMultiAcceptable = (it.id === 'ex14' || it.id === 'ex22');
      
      if(isMultiAcceptable){
        // Mum alevi iÃ§in Ã¶zel kural: IsÄ± veya IÅŸÄ±k'ta doÄŸru kabul et
        if(placement[it.id] === 'isik' || placement[it.id] === 'isi'){
          correct++;
        }
      } else {
        // DiÄŸer kartlar iÃ§in standart kural
        if(placement[it.id] === it.category) correct++;
      }
    }
    return {correct,total};
  }

  // --- EtkileÅŸimler ---
  function handleDrop(e, zoneId){
    e.preventDefault();
    const id = e.dataTransfer.getData('text/plain');
    if(!id) return;
    placement[id] = zoneId; selected = null; render();
  }
  function handleClickItem(id){ selected = (selected === id ? null : id); render(); }
  function handleClickZone(zoneId){ if(!selected) return; placement[selected] = zoneId; selected = null; render(); }

  function resetAll(){ 
    items = shuffle(EXAMPLES); 
    placement = Object.fromEntries(EXAMPLES.map(e=>[e.id,'pool'])); 
    checked = false; 
    selected = null; 
    
    // MasaÃ¼stÃ¼ butonlarÄ± geri yÃ¼kle
    document.getElementById('btnCheckDesktop').style.display = '';
    document.getElementById('btnResetDesktop').style.display = '';
    document.getElementById('btnRevealDesktop').style.display = '';
    
    // Mobil butonlarÄ± geri yÃ¼kle
    document.getElementById('btnCheckMobile').style.display = '';
    document.getElementById('btnResetMobile').style.display = '';
    document.getElementById('btnRevealMobile').style.display = '';

    render(); 
  }
  
  function revealAll(){ 
    for(const it of EXAMPLES) placement[it.id] = it.category; 
    checked = true; 
    selected = null; 
    
    // Kontrol Et butonunu gizleme kodu kaldÄ±rÄ±ldÄ±ÄŸÄ± iÃ§in sadece reset/reveal butonlarÄ± iÃ§in gÃ¶rÃ¼nÃ¼rlÃ¼k ayarÄ± kaldÄ±
    // document.getElementById('btnCheckDesktop').style.display = 'none';
    // document.getElementById('btnCheckMobile').style.display = 'none';
    
    document.getElementById('btnResetDesktop').style.display = '';
    document.getElementById('btnRevealDesktop').style.display = '';
    document.getElementById('btnResetMobile').style.display = '';
    document.getElementById('btnRevealMobile').style.display = '';
    
    render(); 
  }
  
  function checkNow(){ 
    checked = true; 
    render(); 
    
    // Kontrol Et butonunu gizleme kodu kaldÄ±rÄ±ldÄ±
    // document.getElementById('btnCheckDesktop').style.display = 'none';
    // document.getElementById('btnCheckMobile').style.display = 'none';
    
    // Ses ve mesaj kontrolÃ¼
    const score = computeScore();
    let correctCount = score.correct;
    let wrongCount = EXAMPLES.length - correctCount;
    
    if(correctCount > 0 && wrongCount > 0){
      // Hem doÄŸru hem yanlÄ±ÅŸ var
      soundFalse.play();
    } else if(correctCount === EXAMPLES.length){
      // Hepsi doÄŸru!
      soundConq.play();
      setTimeout(()=>{
        document.getElementById('congratsModal').classList.add('show');
      }, 500);
    } else if(wrongCount > 0){
      // Sadece yanlÄ±ÅŸlar var
      soundFalse.play();
    }
  }

  // --- Olay baÄŸlama ---
  document.getElementById('btnCheckDesktop').addEventListener('click', checkNow);
  document.getElementById('btnResetDesktop').addEventListener('click', resetAll);
  document.getElementById('btnRevealDesktop').addEventListener('click', revealAll);
  
  // Mobil butonlarÄ± baÄŸla (Yeni ID'ler)
  document.getElementById('btnCheckMobile').addEventListener('click', checkNow);
  document.getElementById('btnResetMobile').addEventListener('click', resetAll);
  document.getElementById('btnRevealMobile').addEventListener('click', revealAll);


  // --- Mobilde scroll yaparken appbar gizle ---
  let lastScrollTop = 0;
  const appbar = document.querySelector('header.appbar');
  
  window.addEventListener('scroll', ()=>{
    if(window.innerWidth >= 768) return; 
    
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    if(scrollTop > lastScrollTop && scrollTop > 100){
      appbar.classList.add('hidden');
    } else {
      appbar.classList.remove('hidden');
    }
    
    lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
  });

  // --- BaÅŸlat ---
  buildCategoryGrid();
  render();
  </script>
</body>
</html>


